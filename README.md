# Duel Galatea - 游戏王全能插件

![版本](https://img.shields.io/badge/版本-1.4.0-brightgreen)
![AstrBot](https://img.shields.io/badge/AstrBot-v4.0+-blue)

## 🌟 插件简介

Duel Galatea是一个游☆戏☆王全能插件，能够基于百鸽API提供游戏王卡片查询，卡图下载功能，爬取duelmeta网站对当期DL/MD T表进行查询并返回关键卡片，查询ROTK网站爬取当期OCG饼图和示例卡组，读取ydk文件，转化ourocg链接和ydke链接为ydk并生成构筑图片，还有随机一卡和发动强欲的赠礼的娱乐功能，为你的聊天撅斗带来笑容！（

## 🎴 核心功能

### 现在可以使用/游戏王帮助 来快速获取指令的帮助页了！

### 🃏 卡片查询 (/查卡)
- 通过卡片名称搜索卡片信息
- 分页显示搜索结果(10个/页)
- 序号选择查看详情

### 📄 分页切换 (/查卡换页)
- 支持多页结果浏览
- 方便查找目标卡片

### 🖼 高清卡图 (/发送高清卡图)
- 发送指定卡片的高清图像
- 自动记忆最近查看的卡片
- 支持直接通过CID发送

## 🚀 使用方法

### 基本查询
```
/查卡 青眼
```

### 浏览结果
```
1. 青眼白龙
2. 青眼究极龙
3. 青眼光龙

💡 请输入 /查卡序号 [序号] 查看详细信息，或使用 /查卡换页 [页码] 切换页面
```

### 查看详情
```
/查卡序号 1
```

### 切换页面
```
/查卡换页 2
```

### 发送高清卡图
```
// 发送最近查看卡片的高清图:
/发送高清卡图

// 发送指定CID卡片的高清图:
/发送高清卡图 16178681

```

### 详细查询
```
// 查询卡片裁定
/查询裁定

// 查询卡片卡盒
/查询卡盒
```

### 禁卡表（1.4.0）
```
//从官网更新禁卡表信息
/禁卡表更新 [OCG/简中]

//从官网更新Genesys点数信息
/Genesys更新
```

### DL/MD T表相关
```
// 爬取保存最新T表(需要时间):
/DL更新T表
/MD更新T表

// 查询发送已有T表:
/DL查询T表
/MD查询T表

// 尝试使用百鸽api对未汉化的卡组名进行翻译(可能会有问题):
/翻译T表 DL
/翻译T表 MD

// 在DL/MD环境下查询关键卡
(meta界面太难爬了，没找到卡组位置，目前妥协了只能查到关键卡)
/DL查卡组 <英文卡组名或已经有映射的中文卡组名>
/MD查卡组 <英文卡组名或已经有映射的中文卡组名>

// 卡组名翻译映射文件为deck_translations.json,如果遇到翻译问题修改此文件即可

//修改卡组翻译（手动添加翻译或者修改错误的英文翻译映射）
例如：
/修改卡组翻译 Sky Striker 闪刀姬
注意: 最后一个词会被识别为中文，前面的被识别为英文

//查询本地存储的卡组翻译，输入卡组英文名
例如：
/查询卡组翻译 Sky Striker

```

### OCG 饼图
```
// 从RoTK爬取保存最新饼图(需要时间):
/OCG饼图更新

// 查询发送已有饼图:
/OCG饼图
```

### 构筑相关(1.3.0)已完成会话隔离，ydk缓存文件各个群聊/用户独立
```
// 发送缓存的ydk文件(支持查卡组指令的):
/发送ydk

// 发送缓存ydk文件的卡组图片:
/发送卡组图片

// 接收ydk文本内容作为缓存:
/接收ydk文本

// 接收ourocg链接或者ydke链接转化为ydk缓存:
/接收卡组链接

//将群卡组存入私有仓库
/卡组转存

//将私有卡组分享到群聊
/卡组分享

//检查[OCG/简中]禁限与Genesys点数
/卡组检查 [OCG/简中]
```

### 决斗模拟
```
//模拟起手5张 (优先私有，其次群组)
/卡组起手

//模拟抽1张
/卡组抽卡

//检索特定卡片上手(模糊检索)
/卡组检索 <卡名>

//查看手牌/卡组余量
/卡组状态

//洗牌并重置
/卡组状态重置
```

### 用撅斗带来笑容（
```
// 最强的决斗者一切都是必然的:
/随机一卡
(复用查卡代码，可以直接使用/发送高清卡图)

// 我的卡组啊，回应我吧！！！:
/发动王牌圣杯
```

## 📦 安装说明

1. 在插件市场安装本插件
或者将文件夹放入AstrBot的plugins目录
2. 重启AstrBot
3. 在管理面板启用插件
4. (可选)在插件目录下放置任意字体文件，程序会自动读取用于卡图文本书写(在中文字符出现乱码时可选)

## 🔧 依赖说明

- aiohttp (用于API调用)
- Pillow (用于生成卡组图片)
- certifi (解决用户反馈SSL连接问题)

## 更新日志
- v1.0.0 完成查卡组件
- v1.1.0 添加娱乐功能，duelmeta爬取
- v1.2.0 全面使用aiohttp改写，添加rotk爬取
- v1.3.0 修改缓存文件存储位置，添加ydk读取功能
- v1.4.0 添加禁卡表爬取与卡组模拟功能，优化使用体验

## 📞 支持与反馈

如有问题或建议，请联系开发者qq：2721298904，加入交流群635990103（快来玩！）或提交Issue。

同时感谢Astrbot开源项目！！！

由于无法获取DL/MD游戏内内容以及集换社内容（没有可爬取的网页），目前无法爬取DL/MD禁卡表，公告以及卡片价格，如果有方法能够获得或者有志愿者愿意手动维护的话请联系我！！

为啥叫duel galatea捏，因为作者喜欢玩自奏，是机械族牢玩家和地机凯子（？）,好吧其实也有设定的关系，了解自奏剧情的或者这个什么神话含义的应该也知道，ai和生命化的设定真的很适合
所以作者正在开发一点点符合这个名字的全新功能......敬请期待8(doge)